function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("debug"),require("event-emitter"),require("event-emitter/all-off")):"function"==typeof define&&define.amd?define(["debug","event-emitter","event-emitter/all-off"],t):e.transceiver=t(e.debug,e.EventEmitter,e.allOff)}(this,function(e,t,n){"use strict";var r=e("transceiver:channel"),a=function(){function a(n){_classCallCheck(this,a),r("Initializing channel "+n),this.name=n,this.requestHandlers={},this.emitter=new t,this.dbg=e("transceiver:channel:"+n)}return _createClass(a,[{key:"request",value:function(){if(arguments[0]&&Array.isArray(arguments[0]))return this.callMultipleHandlers.apply(this,arguments);if(arguments[0]&&"string"==typeof arguments[0])return this.callHandler.apply(this,arguments);throw new Error("Invalid message name")}},{key:"reply",value:function(){if(arguments[0]&&"object"==typeof arguments[0])this.createMultipleHandlers.apply(this,arguments);else{if(!arguments[0]||"string"!=typeof arguments[0])throw new Error("Invalid message name");this.createHandler.apply(this,arguments)}return this}},{key:"createHandler",value:function(e,t,n){if(this.dbg("Defining new handler for request '"+e+"'"),!t||"function"!=typeof t)throw new Error("Invalid or missing callback");this.requestHandlers[e]&&this.dbg("Request '"+e+"' handler will be overwritten"),this.requestHandlers[e]={callback:t,context:n||this}}},{key:"createMultipleHandlers",value:function(e,t){var n=!0,r=!1,a=void 0;try{for(var i,s=Object.keys(e)[Symbol.iterator]();!(n=(i=s.next()).done);n=!0){var l=i.value;this.createHandler(l,e[l],t)}}catch(u){r=!0,a=u}finally{try{!n&&s["return"]&&s["return"]()}finally{if(r)throw a}}}},{key:"callHandler",value:function(e){if(this.requestHandlers[e]){this.dbg("Calling '"+e+"' request handler");for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;t>r;r++)n[r-1]=arguments[r];return this.requestHandlers[e].callback.apply(this.requestHandlers[e].context,n)}this.dbg("Request '"+e+"' has no handler")}},{key:"callMultipleHandlers",value:function(e,t){var n=this;if(!t)return e.map(this.callHandler,this);var r=function(){var t={};return e.forEach(function(e){t[e]=n.callHandler(e)}),{v:t}}();return"object"==typeof r?r.v:void 0}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments),this}},{key:"emit",value:function(){return this.emitter.emit.apply(this.emitter,arguments),this}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments),this}},{key:"reset",value:function(){return this.dbg("Resetting channel"),this.requestHandlers={},n(this.emitter),this}}]),a}(),i=e("transceiver:main"),s=new(function(){function e(){_classCallCheck(this,e),i("Initializing transceiver"),this.channels={}}return _createClass(e,[{key:"channel",value:function(e){if(!e||"string"!=typeof e)throw new Error("Invalid or missing channel name");return this.channels[e]||(this.channels[e]=new a(e)),this.channels[e]}},{key:"request",value:function(e){for(var t,n=arguments.length,r=Array(n>1?n-1:0),a=1;n>a;a++)r[a-1]=arguments[a];return(t=this.channel(e)).request.apply(t,r)}},{key:"reply",value:function(e){for(var t,n=arguments.length,r=Array(n>1?n-1:0),a=1;n>a;a++)r[a-1]=arguments[a];return(t=this.channel(e)).reply.apply(t,r)}}]),e}());return s});
//# sourceMappingURL=transceiver.min.js.map
