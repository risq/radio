function _toConsumableArray(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)}function _classCallCheck(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}();!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r(require("debug"),require("event-emitter"),require("event-emitter/all-off")):"function"==typeof define&&define.amd?define(["debug","event-emitter","event-emitter/all-off"],r):e.transceiver=r(e.debug,e.EventEmitter,e.allOff)}(this,function(e,r,t){"use strict";var n=e("transceiver:channel"),a=function(){function a(t){_classCallCheck(this,a),n("Initializing channel "+t),this.name=t,this.requestHandlers={},this.emitter=new r,this.dbg=e("transceiver:channel:"+t)}return _createClass(a,[{key:"reply",value:function(){if(arguments[0]&&"object"==typeof arguments[0])this.createMultipleHandlers.apply(this,arguments);else{if(!arguments[0]||"string"!=typeof arguments[0])throw new Error("Invalid message name");this.createHandler.apply(this,arguments)}return this}},{key:"createHandler",value:function(e,r,t){if(this.dbg("Defining new handler for request '"+e+"'"),!r||"function"!=typeof r)throw new Error("Invalid or missing callback");this.requestHandlers[e]&&this.dbg("Request '"+e+"' handler will be overwritten"),this.requestHandlers[e]={callback:r,context:t||this}}},{key:"createMultipleHandlers",value:function(e,r){var t=!0,n=!1,a=void 0;try{for(var i,s=Object.keys(e)[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var l=i.value;this.createHandler(l,e[l],r)}}catch(u){n=!0,a=u}finally{try{!t&&s["return"]&&s["return"]()}finally{if(n)throw a}}}},{key:"request",value:function(){if(arguments[0]&&Array.isArray(arguments[0]))return this.requestArray.apply(this,arguments);if(arguments[0]&&"object"==typeof arguments[0])return this.requestProps.apply(this,arguments);if(arguments[0]&&"string"==typeof arguments[0])return this.callHandler.apply(this,arguments);throw new Error("Invalid message name")}},{key:"callHandler",value:function(e){if(this.requestHandlers[e]){this.dbg("Calling '"+e+"' request handler");for(var r=arguments.length,t=Array(r>1?r-1:0),n=1;r>n;n++)t[n-1]=arguments[n];return this.requestHandlers[e].callback.apply(this.requestHandlers[e].context,t)}this.dbg("Request '"+e+"' has no handler")}},{key:"requestArray",value:function(e){if(Array.isArray(e))return e.map(this.callHandler,this);if("object"==typeof e){var r=[],t=!0,n=!1,a=void 0;try{for(var i,s=Object.keys(e)[Symbol.iterator]();!(t=(i=s.next()).done);t=!0){var l=i.value;r.push(this.callHandler.apply(this,[l].concat(_toConsumableArray(e[l]))))}}catch(u){n=!0,a=u}finally{try{!t&&s["return"]&&s["return"]()}finally{if(n)throw a}}return r}throw new Error("Invalid parameter: requests must be an array or an object of requests")}},{key:"requestProps",value:function(e){var r=this,t={};if(Array.isArray(e))e.forEach(function(e){t[e]=r.callHandler(e)});else{if("object"!=typeof e)throw new Error("Invalid parameter: requests must be an array or an object of requests");var n=!0,a=!1,i=void 0;try{for(var s,l=Object.keys(e)[Symbol.iterator]();!(n=(s=l.next()).done);n=!0){var u=s.value;t[u]=this.callHandler.apply(this,[u].concat(_toConsumableArray(e[u])))}}catch(o){a=!0,i=o}finally{try{!n&&l["return"]&&l["return"]()}finally{if(a)throw i}}}return t}},{key:"on",value:function(){return this.emitter.on.apply(this.emitter,arguments),this}},{key:"emit",value:function(){return this.emitter.emit.apply(this.emitter,arguments),this}},{key:"off",value:function(){return this.emitter.off.apply(this.emitter,arguments),this}},{key:"reset",value:function(){return this.dbg("Resetting channel"),this.requestHandlers={},t(this.emitter),this}}]),a}(),i=e("transceiver:main"),s=new(function(){function e(){_classCallCheck(this,e),i("Initializing transceiver"),this.channels={}}return _createClass(e,[{key:"channel",value:function(e){if(!e||"string"!=typeof e)throw new Error("Invalid or missing channel name");return this.channels[e]||(this.channels[e]=new a(e)),this.channels[e]}},{key:"request",value:function(e){for(var r,t=arguments.length,n=Array(t>1?t-1:0),a=1;t>a;a++)n[a-1]=arguments[a];return(r=this.channel(e)).request.apply(r,n)}},{key:"reply",value:function(e){for(var r,t=arguments.length,n=Array(t>1?t-1:0),a=1;t>a;a++)n[a-1]=arguments[a];return(r=this.channel(e)).reply.apply(r,n)}}]),e}());return s});
//# sourceMappingURL=transceiver.min.js.map
