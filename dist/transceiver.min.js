!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.transceiver=r():e.transceiver=r()}(this,function(){return function(e){function r(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,r),o.loaded=!0,o.exports}var t={};return r.m=e,r.c=t,r.p="",r(0)}([function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var i=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),a=t(1),s=n(a),c=t(4),l=n(c),u=(0,s["default"])("transceiver:main");r["default"]=new(function(){function e(){o(this,e),u("Initializing transceiver"),this.channels={},this.Promise=Promise}return i(e,[{key:"channel",value:function(e){if("string"!=typeof e)throw new Error("Invalid or missing channel name");return this.channels[e]||(u("Initializing channel "+e),this.channels[e]=new l["default"](e),this.channels[e].Promise=this.Promise),this.channels[e]}},{key:"setPromise",value:function(e){u("Setting external promise constructor"),this.Promise=e;var r=!0,t=!1,n=void 0;try{for(var o,i=Object.keys(this.channels)[Symbol.iterator]();!(r=(o=i.next()).done);r=!0){var a=o.value;this.channels[a].Promise=this.Promise}}catch(s){t=!0,n=s}finally{try{!r&&i["return"]&&i["return"]()}finally{if(t)throw n}}}},{key:"request",value:function(e){for(var r,t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return(r=this.channel(e)).request.apply(r,n)}},{key:"reply",value:function(e){for(var r,t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return(r=this.channel(e)).reply.apply(r,n)}},{key:"replyPromise",value:function(e){for(var r,t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return(r=this.channel(e)).replyPromise.apply(r,n)}},{key:"all",value:function(e){for(var r,t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return(r=this.channel(e)).all.apply(r,n)}},{key:"race",value:function(e){for(var r,t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return(r=this.channel(e)).race.apply(r,n)}},{key:"requestArray",value:function(e){for(var r,t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return(r=this.channel(e)).requestArray.apply(r,n)}},{key:"requestProps",value:function(e){for(var r,t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return(r=this.channel(e)).requestProps.apply(r,n)}},{key:"emit",value:function(e){for(var r,t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return(r=this.channel(e)).emit.apply(r,n)}},{key:"on",value:function(e){for(var r,t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return(r=this.channel(e)).on.apply(r,n)}},{key:"once",value:function(e){for(var r,t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return(r=this.channel(e)).once.apply(r,n)}},{key:"off",value:function(e){for(var r,t=arguments.length,n=Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];return(r=this.channel(e)).off.apply(r,n)}},{key:"reset",value:function(e){return this.channel(e).reset()}}]),e}())},function(e,r,t){function n(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function o(){var e=arguments,t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+r.humanize(this.diff),!t)return e;var n="color: "+this.color;e=[e[0],n,"color: inherit"].concat(Array.prototype.slice.call(e,1));var o=0,i=0;return e[0].replace(/%[a-z%]/g,function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))}),e.splice(i,0,n),e}function i(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function a(e){try{null==e?r.storage.removeItem("debug"):r.storage.debug=e}catch(t){}}function s(){var e;try{e=r.storage.debug}catch(t){}return e}function c(){try{return window.localStorage}catch(e){}}r=e.exports=t(2),r.log=i,r.formatArgs=o,r.save=a,r.load=s,r.useColors=n,r.storage="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c(),r.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],r.formatters.j=function(e){return JSON.stringify(e)},r.enable(s())},function(e,r,t){function n(){return r.colors[u++%r.colors.length]}function o(e){function t(){}function o(){var e=o,t=+new Date,i=t-(l||t);e.diff=i,e.prev=l,e.curr=t,l=t,null==e.useColors&&(e.useColors=r.useColors()),null==e.color&&e.useColors&&(e.color=n());var a=Array.prototype.slice.call(arguments);a[0]=r.coerce(a[0]),"string"!=typeof a[0]&&(a=["%o"].concat(a));var s=0;a[0]=a[0].replace(/%([a-z%])/g,function(t,n){if("%%"===t)return t;s++;var o=r.formatters[n];if("function"==typeof o){var i=a[s];t=o.call(e,i),a.splice(s,1),s--}return t}),"function"==typeof r.formatArgs&&(a=r.formatArgs.apply(e,a));var c=o.log||r.log||console.log.bind(console);c.apply(e,a)}t.enabled=!1,o.enabled=!0;var i=r.enabled(e)?o:t;return i.namespace=e,i}function i(e){r.save(e);for(var t=(e||"").split(/[\s,]+/),n=t.length,o=0;o<n;o++)t[o]&&(e=t[o].replace(/\*/g,".*?"),"-"===e[0]?r.skips.push(new RegExp("^"+e.substr(1)+"$")):r.names.push(new RegExp("^"+e+"$")))}function a(){r.enable("")}function s(e){var t,n;for(t=0,n=r.skips.length;t<n;t++)if(r.skips[t].test(e))return!1;for(t=0,n=r.names.length;t<n;t++)if(r.names[t].test(e))return!0;return!1}function c(e){return e instanceof Error?e.stack||e.message:e}r=e.exports=o,r.coerce=c,r.disable=a,r.enable=i,r.enabled=s,r.humanize=t(3),r.names=[],r.skips=[],r.formatters={};var l,u=0},function(e,r){function t(e){if(e=""+e,!(e.length>1e4)){var r=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(r){var t=parseFloat(r[1]),n=(r[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*u;case"days":case"day":case"d":return t*l;case"hours":case"hour":case"hrs":case"hr":case"h":return t*c;case"minutes":case"minute":case"mins":case"min":case"m":return t*s;case"seconds":case"second":case"secs":case"sec":case"s":return t*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t}}}}function n(e){return e>=l?Math.round(e/l)+"d":e>=c?Math.round(e/c)+"h":e>=s?Math.round(e/s)+"m":e>=a?Math.round(e/a)+"s":e+"ms"}function o(e){return i(e,l,"day")||i(e,c,"hour")||i(e,s,"minute")||i(e,a,"second")||e+" ms"}function i(e,r,t){if(!(e<r))return e<1.5*r?Math.floor(e/r)+" "+t:Math.ceil(e/r)+" "+t+"s"}var a=1e3,s=60*a,c=60*s,l=24*c,u=365.25*l;e.exports=function(e,r){return r=r||{},"string"==typeof e?t(e):r["long"]?o(e):n(e)}},function(e,r,t){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function o(e){if(Array.isArray(e)){for(var r=0,t=Array(e.length);r<e.length;r++)t[r]=e[r];return t}return Array.from(e)}function i(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(r,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e},s=function(){function e(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,t,n){return t&&e(r.prototype,t),n&&e(r,n),r}}(),c=t(1),l=n(c),u=t(5),f=n(u),h=t(20),y=n(h),p=function(){function e(r){i(this,e),this.name=r,this.requestHandlers={},this.emitter=new f["default"],this.dbg=(0,l["default"])("transceiver:channel:"+r)}return s(e,[{key:"reply",value:function(){if("object"===a(arguments[0]))this.createMultipleHandlers.apply(this,arguments);else{if("string"!=typeof arguments[0])throw new Error("Invalid request name");this.createHandler.apply(this,arguments)}return this}},{key:"createHandler",value:function(e,r,t){if(this.dbg("Defining new handler for request '"+e+"'"),"function"!=typeof r)throw new Error("Invalid or missing callback");this.requestHandlers[e]&&this.dbg("Warning: Request '"+e+"' handler will be overwritten"),this.requestHandlers[e]={callback:r,context:t||this}}},{key:"createMultipleHandlers",value:function(e,r){var t=!0,n=!1,o=void 0;try{for(var i,a=Object.keys(e)[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;this.createHandler(s,e[s],r)}}catch(c){n=!0,o=c}finally{try{!t&&a["return"]&&a["return"]()}finally{if(n)throw o}}}},{key:"replyPromise",value:function(){if("function"!=typeof this.Promise)throw new Error("No global Promise constructor has been found. Use transceiver.setPromise(Promise) to specify one.");if("object"===a(arguments[0]))this.createMultiplePromiseHandlers.apply(this,arguments);else{if("string"!=typeof arguments[0])throw new Error("Invalid request name");this.createPromiseHandler.apply(this,arguments)}return this}},{key:"createPromiseHandler",value:function(e,r,t){var n=this;if("function"!=typeof r)throw new Error("Invalid or missing callback");this.createHandler(e,function(){return new n.Promise(r.bind(t||n))})}},{key:"createMultiplePromiseHandlers",value:function(e,r){var t=!0,n=!1,o=void 0;try{for(var i,a=Object.keys(e)[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){var s=i.value;this.createPromiseHandler(s,e[s],r)}}catch(c){n=!0,o=c}finally{try{!t&&a["return"]&&a["return"]()}finally{if(n)throw o}}}},{key:"request",value:function(){if(Array.isArray(arguments[0]))return this.requestArray.apply(this,arguments);if("object"===a(arguments[0]))return this.requestProps.apply(this,arguments);if("string"==typeof arguments[0])return this.callHandler.apply(this,arguments);throw new Error("Invalid request name")}},{key:"callHandler",value:function(e){if(this.requestHandlers[e]){this.dbg("Calling '"+e+"' request handler");for(var r=arguments.length,t=Array(r>1?r-1:0),n=1;n<r;n++)t[n-1]=arguments[n];return this.Promise?this.Promise.resolve(this.requestHandlers[e].callback.apply(this.requestHandlers[e].context,t)):this.requestHandlers[e].callback.apply(this.requestHandlers[e].context,t)}if(this.dbg("Warning: Request '"+e+"' has no handler"),this.Promise)return this.Promise.reject(new Error("Request '"+e+"' has no handler"))}},{key:"requestArray",value:function(e){if(Array.isArray(e))return e.map(this.callHandler,this);if("object"===("undefined"==typeof e?"undefined":a(e))){var r=[],t=!0,n=!1,i=void 0;try{for(var s,c=Object.keys(e)[Symbol.iterator]();!(t=(s=c.next()).done);t=!0){var l=s.value,u=Array.isArray(e[l])?e[l]:[e[l]];r.push(this.callHandler.apply(this,[l].concat(o(u))))}}catch(f){n=!0,i=f}finally{try{!t&&c["return"]&&c["return"]()}finally{if(n)throw i}}return r}throw new Error("Invalid parameter: requests must be an array or an object of requests")}},{key:"requestProps",value:function(e){var r=this,t={};if(Array.isArray(e))e.forEach(function(e){t[e]=r.callHandler(e)});else{if("object"!==("undefined"==typeof e?"undefined":a(e)))throw new Error("Invalid parameter: requests must be an array or an object of requests");var n=!0,i=!1,s=void 0;try{for(var c,l=Object.keys(e)[Symbol.iterator]();!(n=(c=l.next()).done);n=!0){var u=c.value,f=Array.isArray(e[u])?e[u]:[e[u]];t[u]=this.callHandler.apply(this,[u].concat(o(f)))}}catch(h){i=!0,s=h}finally{try{!n&&l["return"]&&l["return"]()}finally{if(i)throw s}}}return t}},{key:"all",value:function(e){if("function"!=typeof this.Promise)throw new Error("No global Promise constructor has been found. Use transceiver.setPromise(Promise) to specify one.");return this.Promise.all(this.requestArray(e))}},{key:"race",value:function(e){if("function"!=typeof this.Promise)throw new Error("No global Promise constructor has been found. Use transceiver.setPromise(Promise) to specify one.");return this.Promise.race(this.requestArray(e))}},{key:"on",value:function(e){return this.dbg("Defining new handler for event '"+e+"'"),this.emitter.on.apply(this.emitter,arguments),this}},{key:"once",value:function(e,r){var t=this;return this.dbg("Defining new one-time handler for event '"+e+"'"),!r&&this.Promise?new this.Promise(function(r){return t.emitter.once(e,r)}):void this.emitter.once.apply(this.emitter,arguments)}},{key:"emit",value:function(e){return this.dbg("Emitting new '"+e+"' event"),this.emitter.emit.apply(this.emitter,arguments),this}},{key:"off",value:function(e){return this.dbg("Removing new handler for event '"+e+"'"),this.emitter.off.apply(this.emitter,arguments),this}},{key:"reset",value:function(){return this.dbg("Resetting channel"),this.requestHandlers={},(0,y["default"])(this.emitter),this}}]),e}();r["default"]=p},function(e,r,t){"use strict";var n,o,i,a,s,c,l,u=t(6),f=t(19),h=Function.prototype.apply,y=Function.prototype.call,p=Object.create,d=Object.defineProperty,v=Object.defineProperties,m=Object.prototype.hasOwnProperty,b={configurable:!0,enumerable:!1,writable:!0};n=function(e,r){var t;return f(r),m.call(this,"__ee__")?t=this.__ee__:(t=b.value=p(null),d(this,"__ee__",b),b.value=null),t[e]?"object"==typeof t[e]?t[e].push(r):t[e]=[t[e],r]:t[e]=r,this},o=function(e,r){var t,o;return f(r),o=this,n.call(this,e,t=function(){i.call(o,e,t),h.call(r,this,arguments)}),t.__eeOnceListener__=r,this},i=function(e,r){var t,n,o,i;if(f(r),!m.call(this,"__ee__"))return this;if(t=this.__ee__,!t[e])return this;if(n=t[e],"object"==typeof n)for(i=0;o=n[i];++i)o!==r&&o.__eeOnceListener__!==r||(2===n.length?t[e]=n[i?0:1]:n.splice(i,1));else n!==r&&n.__eeOnceListener__!==r||delete t[e];return this},a=function(e){var r,t,n,o,i;if(m.call(this,"__ee__")&&(o=this.__ee__[e]))if("object"==typeof o){for(t=arguments.length,i=new Array(t-1),r=1;r<t;++r)i[r-1]=arguments[r];for(o=o.slice(),r=0;n=o[r];++r)h.call(n,this,i)}else switch(arguments.length){case 1:y.call(o,this);break;case 2:y.call(o,this,arguments[1]);break;case 3:y.call(o,this,arguments[1],arguments[2]);break;default:for(t=arguments.length,i=new Array(t-1),r=1;r<t;++r)i[r-1]=arguments[r];h.call(o,this,i)}},s={on:n,once:o,off:i,emit:a},c={on:u(n),once:u(o),off:u(i),emit:u(a)},l=v({},c),e.exports=r=function(e){return null==e?p(l):v(Object(e),c)},r.methods=s},function(e,r,t){"use strict";var n,o=t(7),i=t(14),a=t(15),s=t(16);n=e.exports=function(e,r){var t,n,a,c,l;return arguments.length<2||"string"!=typeof e?(c=r,r=e,e=null):c=arguments[2],null==e?(t=a=!0,n=!1):(t=s.call(e,"c"),n=s.call(e,"e"),a=s.call(e,"w")),l={value:r,configurable:t,enumerable:n,writable:a},c?o(i(c),l):l},n.gs=function(e,r,t){var n,c,l,u;return"string"!=typeof e?(l=t,t=r,r=e,e=null):l=arguments[3],null==r?r=void 0:a(r)?null==t?t=void 0:a(t)||(l=t,t=void 0):(l=r,r=t=void 0),null==e?(n=!0,c=!1):(n=s.call(e,"c"),c=s.call(e,"e")),u={get:r,set:t,configurable:n,enumerable:c},l?o(i(l),u):u}},function(e,r,t){"use strict";e.exports=t(8)()?Object.assign:t(9)},function(e,r){"use strict";e.exports=function(){var e,r=Object.assign;return"function"==typeof r&&(e={foo:"raz"},r(e,{bar:"dwa"},{trzy:"trzy"}),e.foo+e.bar+e.trzy==="razdwatrzy")}},function(e,r,t){"use strict";var n=t(10),o=t(13),i=Math.max;e.exports=function(e,r){var t,a,s,c=i(arguments.length,2);for(e=Object(o(e)),s=function(n){try{e[n]=r[n]}catch(o){t||(t=o)}},a=1;a<c;++a)r=arguments[a],n(r).forEach(s);if(void 0!==t)throw t;return e}},function(e,r,t){"use strict";e.exports=t(11)()?Object.keys:t(12)},function(e,r){"use strict";e.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},function(e,r){"use strict";var t=Object.keys;e.exports=function(e){return t(null==e?e:Object(e))}},function(e,r){"use strict";e.exports=function(e){if(null==e)throw new TypeError("Cannot use null or undefined");return e}},function(e,r){"use strict";var t=Array.prototype.forEach,n=Object.create,o=function(e,r){var t;for(t in e)r[t]=e[t]};e.exports=function(e){var r=n(null);return t.call(arguments,function(e){null!=e&&o(Object(e),r)}),r}},function(e,r){"use strict";e.exports=function(e){return"function"==typeof e}},function(e,r,t){"use strict";e.exports=t(17)()?String.prototype.contains:t(18)},function(e,r){"use strict";var t="razdwatrzy";e.exports=function(){return"function"==typeof t.contains&&(t.contains("dwa")===!0&&t.contains("foo")===!1)}},function(e,r){"use strict";var t=String.prototype.indexOf;e.exports=function(e){return t.call(this,e,arguments[1])>-1}},function(e,r){"use strict";e.exports=function(e){if("function"!=typeof e)throw new TypeError(e+" is not a function");return e}},function(e,r,t){"use strict";var n=t(21),o=Object.prototype.hasOwnProperty;e.exports=function(e){var r,t=arguments[1];if(n(e),void 0!==t){if(r=o.call(e,"__ee__")&&e.__ee__,!r)return;return void(r[t]&&delete r[t])}o.call(e,"__ee__")&&delete e.__ee__}},function(e,r,t){"use strict";var n=t(22);e.exports=function(e){if(!n(e))throw new TypeError(e+" is not an Object");return e}},function(e,r){"use strict";var t={"function":!0,object:!0};e.exports=function(e){return null!=e&&t[typeof e]||!1}}])});
//# sourceMappingURL=transceiver.min.js.map
